# CORS 오류 최종 해결 방법

## 현재 문제
- Google Apps Script가 200 OK로 응답하지만 CORS 헤더가 없어 브라우저가 차단
- "액세스 권한: 모든 사용자"로 설정했어도 작동하지 않음

## 최종 해결 방법

### 방법 1: Google Apps Script 완전 재배포 (가장 확실)

**완전히 새로 시작하는 방법:**

1. **기존 배포 완전 삭제**
   - Google Apps Script 편집기
   - `배포` → `배포 관리`
   - 기존 배포 옆의 **휴지통 아이콘** 클릭
   - **완전히 삭제** 확인

2. **코드 재확인**
   - `GOOGLE_APPS_SCRIPT_FULL_CODE.js` 전체 내용 복사
   - Google Apps Script 편집기에 붙여넣기
   - 저장 (Ctrl+S)

3. **새로 배포 (중요!)**
   - `배포` → `새 배포` 클릭
   - `유형 선택` → `웹 앱` 선택
   - 설정:
     - 설명: `예산관리시스템`
     - **다음 사용자로 실행: `나`** ⚠️
     - **액세스 권한: `모든 사용자`** ⚠️ **반드시!**
   - `배포` 클릭
   - **새 URL 복사**

4. **권한 승인**
   - 복사한 URL을 브라우저에서 직접 열기
   - 권한 승인 팝업에서 `허용` 클릭
   - JSON 응답이 보이면 성공

5. **프론트엔드 설정**
   - 설정 페이지로 이동
   - "Google Apps Script Web App URL"에 **새 URL** 입력
   - 저장

6. **테스트**
   - 파일 업로드 페이지에서 버튼 클릭
   - Console에서 오류 확인

---

### 방법 2: 백엔드 프록시 사용 (CORS 문제 완전 해결)

Google Apps Script를 직접 호출하지 않고, 백엔드 서버를 통해 프록시로 호출하는 방법입니다.

**장점:**
- CORS 문제 완전 해결
- 더 안정적
- 오류 처리 용이

**단점:**
- 백엔드 코드 수정 필요

---

### 방법 3: Google Sheets API 직접 사용

Google Apps Script 대신 Google Sheets API를 직접 사용하는 방법입니다.

**장점:**
- CORS 문제 없음
- 공식 API 사용
- 더 빠름

**단점:**
- OAuth 인증 설정 필요
- API 키 관리 필요

---

## 추천 순서

1. **먼저 방법 1 시도** (5분 소요)
   - 기존 배포 삭제 후 완전히 새로 배포
   - 이것만으로도 대부분 해결됨

2. **방법 1이 실패하면 방법 2** (30분 소요)
   - 백엔드 프록시 구현
   - CORS 문제 완전 해결

3. **방법 2가 복잡하면 방법 3** (1시간 소요)
   - Google Sheets API 직접 사용
   - 가장 안정적이지만 설정이 복잡

---

## 지금 바로 시도할 것

**방법 1의 1-3단계를 정확히 따라해주세요:**
1. 기존 배포 완전 삭제
2. 코드 재확인 및 저장
3. **새로 배포** (기존 배포 수정이 아닌 완전히 새로 만들기)

이것이 가장 확실한 해결 방법입니다.

