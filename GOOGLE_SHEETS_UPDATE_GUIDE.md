# Google Sheets 업데이트 가이드

## 🔴 문제 상황
Google Sheets에 천 단위 구분 쉼표와 산식 검증 컬럼이 표시되지 않습니다.

## ✅ 해결 방법

### 방법 1: Google Apps Script 코드 업데이트 및 재배포 (권장)

1. **Google Apps Script 편집기 열기**
   - https://script.google.com 접속
   - 프로젝트 선택

2. **코드 업데이트**
   - `GOOGLE_APPS_SCRIPT_FULL_CODE.js` 파일의 전체 코드 복사
   - Google Apps Script 편집기에 붙여넣기 (기존 코드 완전히 교체)
   - **저장**

3. **새 버전으로 배포**
   - **"배포"** > **"배포 관리"** 클릭
   - 기존 배포 옆의 **"수정"** (연필 아이콘) 클릭
   - **"새 버전으로 배포"** 선택 ⭐
   - **"배포"** 버튼 클릭

4. **기존 스프레드시트 ID 삭제**
   - 예산 관리 시스템 설정 페이지로 이동
   - **"Google Sheets ID"** 필드를 **비워두기**
   - 저장

5. **다시 내보내기**
   - 예산 관리 페이지에서 **"Google Sheets로 내보내기"** 클릭
   - 새 스프레드시트가 생성되며 모든 기능이 적용됨

---

### 방법 2: 기존 스프레드시트 수동 삭제 후 재생성

1. **기존 스프레드시트 삭제**
   - Google Drive에서 기존 스프레드시트 찾기
   - 삭제

2. **설정에서 스프레드시트 ID 삭제**
   - 예산 관리 시스템 설정 페이지
   - **"Google Sheets ID"** 필드 비우기
   - 저장

3. **다시 내보내기**
   - 예산 관리 페이지에서 **"Google Sheets로 내보내기"** 클릭
   - 새 스프레드시트가 생성됨

---

## 📋 확인 사항

### Google Sheets에 다음이 표시되어야 합니다:

1. **컬럼 구조**
   - A: 사업명
   - B: 소관부서
   - C: 총예산
   - D: 출연금-도비
   - E: 출연금-시군비
   - F: 보조금-국비
   - G: 보조금-도비
   - H: 보조금-시군비
   - I: 자체재원
   - **J: 산식검증** ⭐ (새로 추가됨)
   - **K: 산식오류** ⭐ (새로 추가됨)

2. **숫자 형식**
   - 모든 숫자에 천 단위 구분 쉼표가 표시됨
   - 예: `1,000,000` 형식

3. **산식 검증**
   - J열(산식검증)에 수식이 자동으로 입력됨
   - K열(산식오류)에 "정상" 또는 "오류" 표시
   - 산식 오류가 있는 행은 빨간 배경색으로 표시

---

## 🔍 문제 진단

### 코드가 배포되지 않은 경우

- Google Apps Script 편집기에서 코드를 확인
- `syncToSheets` 함수에 다음이 있는지 확인:
  - `headers` 배열에 '산식검증', '산식오류' 포함
  - `setNumberFormat('#,##0')` 호출
  - 산식 검증 수식 추가

### 기존 스프레드시트를 사용하는 경우

- 기존 스프레드시트는 이전 형식으로 되어 있음
- 새 스프레드시트를 생성해야 함
- 설정에서 스프레드시트 ID를 삭제하고 다시 내보내기

---

## 💡 참고

코드가 업데이트되었습니다:
- 기존 시트의 데이터를 자동으로 삭제하고 새로 작성
- 모든 기능이 새로 적용됨

**중요**: Google Apps Script 코드를 업데이트한 후 반드시 **"새 버전으로 배포"**해야 합니다!

