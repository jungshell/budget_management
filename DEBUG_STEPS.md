# ë””ë²„ê¹… ë‹¨ê³„ë³„ ê°€ì´ë“œ

## ğŸ”´ ë¬¸ì œ: ì½”ë“œë¥¼ ìˆ˜ì •í•˜ê³  ë°°í¬í–ˆëŠ”ë°ë„ ê²°ê³¼ê°€ ê°™ìŒ

## âœ… ë‹¨ê³„ë³„ í™•ì¸ ë°©ë²•

### 1ë‹¨ê³„: Google Apps Script ì‹¤í–‰ ë¡œê·¸ í™•ì¸

1. **Google Apps Script í¸ì§‘ê¸° ì—´ê¸°**
   - https://script.google.com ì ‘ì†
   - í”„ë¡œì íŠ¸ ì„ íƒ

2. **ì‹¤í–‰ ë¡œê·¸ í™•ì¸**
   - í¸ì§‘ê¸° í•˜ë‹¨ì˜ **"ì‹¤í–‰ ë¡œê·¸"** íƒ­ í´ë¦­
   - ë˜ëŠ” **"ë³´ê¸°"** > **"ì‹¤í–‰"** ë©”ë‰´ ì„ íƒ

3. **ìµœê·¼ ì‹¤í–‰ í™•ì¸**
   - "Google Sheetsë¡œ ë‚´ë³´ë‚´ê¸°"ë¥¼ ì‹¤í–‰í•œ í›„
   - ì‹¤í–‰ ë¡œê·¸ì—ì„œ ë‹¤ìŒì„ í™•ì¸:
     - `doPost called with action: sync`
     - `Received data: ...`
     - `Spreadsheet title: ...`
     - `Year: ... Version: ...`

4. **ì˜¤ë¥˜ í™•ì¸**
   - ë¹¨ê°„ìƒ‰ ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ìˆëŠ”ì§€ í™•ì¸
   - ì˜¤ë¥˜ê°€ ìˆìœ¼ë©´ ë©”ì‹œì§€ë¥¼ ë³µì‚¬í•˜ì—¬ ì•Œë ¤ì£¼ì„¸ìš”

---

### 2ë‹¨ê³„: ë°°í¬ ë²„ì „ í™•ì¸

1. **"ë°°í¬"** > **"ë°°í¬ ê´€ë¦¬"** í´ë¦­
2. ë°°í¬ ëª©ë¡ì—ì„œ:
   - **ìµœì‹  ë°°í¬ì˜ ë‚ ì§œ/ì‹œê°„** í™•ì¸
   - ë°©ê¸ˆ ë°°í¬í•œ ê²ƒì¸ì§€ í™•ì¸
   - **Web App URL** ë³µì‚¬

3. **ì„¤ì • í˜ì´ì§€ì™€ ë¹„êµ**
   - ì˜ˆì‚° ê´€ë¦¬ ì‹œìŠ¤í…œ ì„¤ì • í˜ì´ì§€
   - "Google Apps Script Web App URL"ê³¼ ë¹„êµ
   - **ë‹¤ë¥´ë©´ ìƒˆ URLë¡œ ì—…ë°ì´íŠ¸**

---

### 3ë‹¨ê³„: ì™„ì „íˆ ìƒˆë¡œ ì‹œì‘ (ê¶Œì¥)

#### ë°©ë²• A: ê¸°ì¡´ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì™„ì „ ì‚­ì œ

1. **Google Driveì—ì„œ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì°¾ê¸°**
   - Google Drive ì—´ê¸°
   - "ì˜ˆì‚° ë°ì´í„°"ë¡œ ê²€ìƒ‰
   - ëª¨ë“  ê´€ë ¨ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì°¾ê¸°

2. **ì™„ì „ ì‚­ì œ**
   - ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì„ íƒ
   - ìš°í´ë¦­ > **"ì‚­ì œ"**
   - **íœ´ì§€í†µì—ì„œë„ ì™„ì „ ì‚­ì œ** (íœ´ì§€í†µ ë¹„ìš°ê¸°)

3. **ì„¤ì •ì—ì„œ ID ì‚­ì œ**
   - ì˜ˆì‚° ê´€ë¦¬ ì‹œìŠ¤í…œ ì„¤ì • í˜ì´ì§€
   - "Google Sheets ID" í•„ë“œ **ì™„ì „íˆ ë¹„ìš°ê¸°**
   - ì €ì¥

4. **ë‹¤ì‹œ ë‚´ë³´ë‚´ê¸°**
   - ì˜ˆì‚° ê´€ë¦¬ í˜ì´ì§€
   - "Google Sheetsë¡œ ë‚´ë³´ë‚´ê¸°" í´ë¦­
   - ìƒˆ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ê°€ ìƒì„±ë˜ì–´ì•¼ í•¨

#### ë°©ë²• B: Google Apps Script í”„ë¡œì íŠ¸ ì™„ì „ ì¬ìƒì„±

1. **ê¸°ì¡´ í”„ë¡œì íŠ¸ ì‚­ì œ**
   - Google Apps Script í¸ì§‘ê¸°
   - í”„ë¡œì íŠ¸ ì„¤ì • > í”„ë¡œì íŠ¸ ì‚­ì œ

2. **ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±**
   - "ìƒˆ í”„ë¡œì íŠ¸" í´ë¦­
   - í”„ë¡œì íŠ¸ ì´ë¦„: "ì˜ˆì‚°ê´€ë¦¬ì‹œìŠ¤í…œ ì—°ë™"

3. **ì½”ë“œ ë³µì‚¬**
   - `GOOGLE_APPS_SCRIPT_FULL_CODE.js` íŒŒì¼ì˜ ì „ì²´ ì½”ë“œ ë³µì‚¬
   - ìƒˆ í”„ë¡œì íŠ¸ì— ë¶™ì—¬ë„£ê¸°
   - **ì €ì¥**

4. **ìƒˆë¡œ ë°°í¬**
   - "ë°°í¬" > "ìƒˆ ë°°í¬"
   - ìœ í˜•: "ì›¹ ì•±"
   - ì„¤ì •:
     - ë‹¤ìŒ ì‚¬ìš©ìë¡œ ì‹¤í–‰: ë‚˜
     - ì•¡ì„¸ìŠ¤ ê¶Œí•œ: ëª¨ë“  ì‚¬ìš©ì
   - **ë°°í¬**
   - **ìƒˆ Web App URL ë³µì‚¬**

5. **ì„¤ì • ì—…ë°ì´íŠ¸**
   - ì˜ˆì‚° ê´€ë¦¬ ì‹œìŠ¤í…œ ì„¤ì • í˜ì´ì§€
   - ìƒˆ Web App URL ì…ë ¥
   - Google Sheets ID ë¹„ìš°ê¸°
   - ì €ì¥

6. **í…ŒìŠ¤íŠ¸**
   - ì˜ˆì‚° ê´€ë¦¬ í˜ì´ì§€
   - "Google Sheetsë¡œ ë‚´ë³´ë‚´ê¸°" í´ë¦­

---

### 4ë‹¨ê³„: ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ í™•ì¸

1. **ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ ì—´ê¸°** (F12)
2. **Console íƒ­** í™•ì¸
3. **"Google Sheetsë¡œ ë‚´ë³´ë‚´ê¸°" ì‹¤í–‰**
4. **ì½˜ì†” ë©”ì‹œì§€ í™•ì¸**:
   - ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ìˆëŠ”ì§€
   - ìš”ì²­ì´ ì„±ê³µí–ˆëŠ”ì§€
   - ì‘ë‹µ ë°ì´í„° í™•ì¸

5. **Network íƒ­ í™•ì¸**
   - "Google Sheetsë¡œ ë‚´ë³´ë‚´ê¸°" ì‹¤í–‰
   - Google Apps Script URLë¡œì˜ ìš”ì²­ í™•ì¸
   - ìš”ì²­ ë³¸ë¬¸(request payload) í™•ì¸:
     - `year` í•„ë“œê°€ ìˆëŠ”ì§€
     - `version` í•„ë“œê°€ ìˆëŠ”ì§€
     - `data` ë°°ì—´ì´ ìˆëŠ”ì§€

---

## ğŸ” í™•ì¸í•  ì½”ë“œ ë¶€ë¶„

### Google Apps Scriptì—ì„œ í™•ì¸

`syncToSheets` í•¨ìˆ˜ì˜ ì‹œì‘ ë¶€ë¶„:

```javascript
function syncToSheets(data) {
  try {
    const spreadsheetId = data.spreadsheetId;
    const sheetName = data.sheetName || 'ì˜ˆì‚°ë°ì´í„°';
    const budgetData = data.data;
    const year = data.year || new Date().getFullYear();
    const version = data.version || 'ë³¸ì˜ˆì‚°';
    
    // ì—¬ê¸°ì„œ yearì™€ versionì´ ì œëŒ€ë¡œ ë“¤ì–´ì˜¤ëŠ”ì§€ í™•ì¸
    console.log('Year:', year, 'Version:', version);
    
    // ì œëª© ìƒì„±
    const now = new Date();
    const yearStr = String(now.getFullYear()).substring(2);
    const monthStr = String(now.getMonth() + 1).padStart(2, '0');
    const dateStr = String(now.getDate()).padStart(2, '0');
    const spreadsheetTitle = year + '_' + version + '_' + yearStr + monthStr + dateStr;
    
    console.log('Spreadsheet title:', spreadsheetTitle);
```

### í”„ë¡ íŠ¸ì—”ë“œì—ì„œ í™•ì¸

`Budgets.tsx`ì˜ `handleExportToGoogleSheets` í•¨ìˆ˜:

```typescript
const config: GoogleSheetsConfig & { year?: number; version?: string } = {
  scriptUrl,
  spreadsheetId: sheetsId || undefined,
  sheetName: `${selectedYear}ë…„_${selectedVersion}`,
  year: selectedYear,  // ì´ ê°’ì´ ì œëŒ€ë¡œ ì „ë‹¬ë˜ëŠ”ì§€ í™•ì¸
  version: selectedVersion,  // ì´ ê°’ì´ ì œëŒ€ë¡œ ì „ë‹¬ë˜ëŠ”ì§€ í™•ì¸
};
```

---

## ğŸ’¡ ë¹ ë¥¸ í•´ê²° ë°©ë²•

ê°€ì¥ í™•ì‹¤í•œ ë°©ë²•:

1. **Google Driveì—ì„œ ëª¨ë“  "ì˜ˆì‚° ë°ì´í„°" ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì‚­ì œ**
2. **ì„¤ì •ì—ì„œ Google Sheets ID ì™„ì „íˆ ì‚­ì œ**
3. **Google Apps Script ì½”ë“œ ë‹¤ì‹œ í™•ì¸ ë° ì €ì¥**
4. **ìƒˆ ë²„ì „ìœ¼ë¡œ ë°°í¬**
5. **ë¸Œë¼ìš°ì € ìºì‹œ í´ë¦¬ì–´** (Ctrl+Shift+Delete)
6. **ë‹¤ì‹œ ë‚´ë³´ë‚´ê¸°**

---

## ğŸ“ ë¬¸ì œê°€ ê³„ì†ë˜ë©´

ë‹¤ìŒ ì •ë³´ë¥¼ ì œê³µí•´ì£¼ì„¸ìš”:

1. **Google Apps Script ì‹¤í–‰ ë¡œê·¸** (ìŠ¤í¬ë¦°ìƒ· ë˜ëŠ” í…ìŠ¤íŠ¸)
2. **ë¸Œë¼ìš°ì € ì½˜ì†” ì˜¤ë¥˜ ë©”ì‹œì§€** (ìˆë‹¤ë©´)
3. **Network íƒ­ì˜ ìš”ì²­ ë³¸ë¬¸** (request payload)
4. **ë°°í¬ ê´€ë¦¬ í™”ë©´** (ë°°í¬ ë‚ ì§œ í™•ì¸)

