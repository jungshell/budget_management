# 엑셀 업로드 가이드

## 📋 현재 기능 상태

### ✅ 현재 지원하는 기능

1. **단일 파일 업로드**
   - 한 번에 하나의 엑셀 파일 업로드
   - Excel (.xlsx, .xls), CSV (.csv), Numbers (.numbers) 지원

2. **회차 선택**
   - 사이드바에서 연도/회차 선택 후 업로드
   - 지원 회차: 본예산, 1차 추경, 2차 추경, 3차 추경

3. **자동 컬럼 매핑**
   - 사업명, 소관부서, 합계 등 자동 인식
   - 재원구분(국비/도비/시군비/자체) 자동 매핑

---

## ❓ 질문에 대한 답변

### 1. 추경 입력하는 방법은?

**현재 방법:**
1. 사이드바에서 **회차**를 선택합니다 (예: "1차 추경")
2. 파일 업로드 페이지로 이동
3. 엑셀 파일을 업로드
4. 선택한 회차로 자동 저장됩니다

**주의사항:**
- 엑셀 파일 내에서 추경 정보를 자동으로 추출하지 않습니다
- 업로드 전에 사이드바에서 올바른 회차를 선택해야 합니다

**개선 필요:**
- 파일명이나 시트명에서 추경 정보 자동 추출 기능 추가 예정

---

### 2. 여러 엑셀파일 올려도 다 분석해서 예산 입력 할 수 있어?

**현재 상태: ❌ 불가능**

- 현재는 한 번에 **하나의 파일만** 업로드 가능합니다
- 여러 파일을 업로드하려면 각각 개별적으로 업로드해야 합니다

**개선 예정:**
- 다중 파일 업로드 기능 추가 예정
- 여러 파일을 한 번에 선택하여 업로드 가능하도록 개선

---

### 3. 엑셀 업로드 시 어떤 키워드가 어디에 있어야 몇년의 몇회차 정보인지 알 수 있어?

**현재 상태: ❌ 자동 추출 불가**

현재 시스템은 엑셀 파일에서 연도/회차 정보를 자동으로 추출하지 않습니다.

**현재 동작:**
- 사이드바에서 선택한 연도/회차를 사용합니다
- 엑셀 파일의 내용과 무관하게 선택한 값으로 저장됩니다

**자동 추출을 위한 권장 파일명 형식 (향후 지원 예정):**

```
예시:
- "2024년 본예산.xlsx" → 2024년, 본예산
- "2024_본예산.xlsx" → 2024년, 본예산
- "2024년 1차 추경.xlsx" → 2024년, 1차 추경
- "2024_1차추경.xlsx" → 2024년, 1차 추경
- "2025년_2차추경_예산.xlsx" → 2025년, 2차 추경
```

**엑셀 파일 내에서 인식할 수 있는 위치 (향후 지원 예정):**

1. **시트명**
   - 예: "2024년 본예산", "1차 추경"

2. **A1 셀 또는 헤더 영역**
   - 예: "2024년도 본예산", "2024년 1차 추경예산"

3. **파일명**
   - 예: "2024년_본예산.xlsx", "2024_1차추경.xlsx"

**인식 가능한 키워드 (향후 지원 예정):**

- **연도**: "2024", "2024년", "2024년도"
- **회차**: 
  - "본예산", "본 예산", "예산"
  - "1차 추경", "1차추경", "추경1차"
  - "2차 추경", "2차추경", "추경2차"
  - "3차 추경", "3차추경", "추경3차"

---

## 🚀 개선 계획

### 우선순위 1: 파일명에서 연도/회차 자동 추출

**구현 예정:**
- 파일명에서 연도와 회차 정보 자동 추출
- 추출된 정보로 사이드바 자동 선택 또는 확인 다이얼로그 표시

**예시:**
```
파일명: "2024년 1차 추경.xlsx"
→ 자동으로 2024년, 1차 추경 선택 제안
```

### 우선순위 2: 다중 파일 업로드

**구현 예정:**
- 여러 파일을 한 번에 선택하여 업로드
- 각 파일별로 연도/회차 자동 추출 및 저장

**예시:**
```
파일1: "2024년 본예산.xlsx" → 2024년 본예산으로 저장
파일2: "2024년 1차 추경.xlsx" → 2024년 1차 추경으로 저장
파일3: "2025년 본예산.xlsx" → 2025년 본예산으로 저장
```

### 우선순위 3: 엑셀 파일 내부에서 연도/회차 추출

**구현 예정:**
- 시트명에서 연도/회차 추출
- A1 셀 또는 헤더 영역에서 연도/회차 추출
- 파일명과 파일 내부 정보를 모두 확인하여 가장 정확한 정보 사용

---

## 📝 현재 사용 방법

### 추경 입력하기

1. **사이드바에서 회차 선택**
   ```
   사이드바 → 회차 드롭다운 → "1차 추경" 선택
   ```

2. **파일 업로드**
   ```
   파일 업로드 페이지 → 파일 선택 → 업로드
   ```

3. **확인**
   ```
   업로드 완료 후 예산 페이지에서 선택한 회차의 데이터 확인
   ```

### 여러 파일 업로드하기 (현재)

**현재는 각각 개별 업로드 필요:**

1. 첫 번째 파일 업로드
   - 사이드바에서 연도/회차 선택
   - 파일 업로드

2. 두 번째 파일 업로드
   - 사이드바에서 다른 연도/회차 선택
   - 파일 업로드

3. 반복...

---

## 💡 권장 사항

### 파일명 규칙 (향후 자동 인식 지원)

**권장 형식:**
```
{연도}년 {회차}.xlsx
예: "2024년 본예산.xlsx"
예: "2024년 1차 추경.xlsx"
예: "2025년 2차 추경.xlsx"
```

**또는:**
```
{연도}_{회차}.xlsx
예: "2024_본예산.xlsx"
예: "2024_1차추경.xlsx"
```

### 엑셀 파일 구조 권장사항

1. **시트명에 연도/회차 포함** (향후 지원)
   ```
   시트명: "2024년 본예산"
   ```

2. **A1 셀에 연도/회차 명시** (향후 지원)
   ```
   A1: "2024년도 본예산"
   ```

---

## 🔧 향후 개선 사항

- [ ] 파일명에서 연도/회차 자동 추출
- [ ] 시트명에서 연도/회차 자동 추출
- [ ] 엑셀 파일 내부(A1 셀 등)에서 연도/회차 자동 추출
- [ ] 다중 파일 업로드 지원
- [ ] 업로드 전 연도/회차 확인 다이얼로그
- [ ] 파일명 규칙 검증 및 제안

---

## ❓ 문의사항

추가 질문이나 개선 요청이 있으시면 알려주세요!

