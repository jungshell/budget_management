# Google Sheets 동기화 가이드

## 표준 형식으로 생성된 Google Sheets 수정 후 동기화 방법

### 1. 표준 형식 Google Sheets 생성

1. **파일 업로드 페이지**로 이동
2. 엑셀 파일을 업로드
3. **"표준 형식으로 Google Sheets 생성"** 버튼 클릭
4. 새 탭에서 Google Sheets가 열립니다

### 2. Google Sheets에서 데이터 수정

Google Sheets에서 다음 항목들을 수정할 수 있습니다:
- 사업명
- 소관부서
- 예산 금액 (출연금, 보조금, 자체재원 등)
- 시군별 세부 항목

**중요:** 
- 수정 후 반드시 **저장**하세요
- 시트 이름이 `{연도}년_{회차}_표준형식` 형식이어야 합니다 (예: `2024년_1차 추경_표준형식`)

### 3. 수정된 데이터를 앱으로 가져오기 (동기화)

#### 방법 1: Google Sheets URL 사용

1. **파일 업로드 페이지**로 이동
2. **"Google Sheets에서 가져오기"** 섹션으로 스크롤
3. Google Sheets의 **URL을 복사**하여 입력란에 붙여넣기
   - 예: `https://docs.google.com/spreadsheets/d/1ABC123.../edit`
4. 사이드바에서 **올바른 연도와 회차 선택** (예: 2024년, 1차 추경)
5. **"가져오기"** 버튼 클릭
6. 미리보기에서 데이터 확인
7. **"가져온 데이터 저장"** 버튼 클릭

#### 방법 2: Google Sheets ID 사용

1. Google Sheets URL에서 **스프레드시트 ID 추출**
   - URL 형식: `https://docs.google.com/spreadsheets/d/{ID}/edit`
   - 예: `1ABC123xyz...` 부분이 ID입니다
2. **파일 업로드 페이지**로 이동
3. **"Google Sheets에서 가져오기"** 섹션에서
4. **"Google Sheets URL 또는 ID"** 입력란에 **ID만 입력**
5. 사이드바에서 **올바른 연도와 회차 선택**
6. **"가져오기"** 버튼 클릭
7. 미리보기에서 데이터 확인
8. **"가져온 데이터 저장"** 버튼 클릭

### 4. 동기화 확인

- 저장 완료 후 **예산 관리 페이지**에서 수정된 데이터 확인
- 대시보드에서 업데이트된 예산 정보 확인

## 주의사항

1. **시트 이름 확인**: 
   - 시트 이름이 `{연도}년_{회차}_표준형식` 형식이어야 합니다
   - 예: `2024년_1차 추경_표준형식`

2. **연도/회차 선택**:
   - 사이드바에서 Google Sheets와 일치하는 연도와 회차를 선택해야 합니다
   - 잘못된 연도/회차를 선택하면 데이터를 찾을 수 없습니다

3. **Google Apps Script URL 설정**:
   - 처음 사용하는 경우 **설정 페이지**에서 Google Apps Script URL을 설정해야 합니다
   - Google Apps Script 배포 URL을 입력하세요

4. **데이터 형식**:
   - 표준 형식으로 생성된 시트만 가져올 수 있습니다
   - 일반 엑셀 형식은 지원하지 않습니다

## 문제 해결

### "가져올 데이터가 없습니다" 오류
- 시트 이름이 올바른지 확인하세요
- 사이드바에서 선택한 연도/회차가 시트 이름과 일치하는지 확인하세요
- 시트에 데이터가 있는지 확인하세요

### "Google Apps Script URL이 설정되지 않았습니다" 오류
- 설정 페이지로 이동하여 Google Apps Script URL을 입력하세요

### "Google Sheets ID를 확인할 수 없습니다" 오류
- Google Sheets URL 형식이 올바른지 확인하세요
- URL에서 스프레드시트 ID를 올바르게 추출했는지 확인하세요








