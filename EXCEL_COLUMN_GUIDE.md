# Excel 파일 컬럼 구조 가이드

## 📋 권장 컬럼 구조

Excel 파일을 업로드할 때 다음 컬럼 구조를 사용하면 정확하게 파싱됩니다.

### 필수 컬럼

1. **사업명** (또는 "사업", "프로젝트")
2. **소관부서** (또는 "부서", "담당부서", "소관")
3. **합계** (또는 "총액", "예산액", "총예산", "예산")

### 재원별 컬럼 구조 (권장)

#### 방법 1: 세부 컬럼 분리 (권장) ⭐

각 재원을 세부적으로 분리하여 컬럼을 만듭니다:

```
사업명 | 소관부서 | 합계 | 출연금-도비 | 출연금-천안시 | 출연금-아산시 | ... | 보조금-국비 | 보조금-도비 | 보조금-천안시 | ... | 자체재원
```

**예시:**
- `출연금-도비`: 도비 출연금
- `출연금-천안시`: 천안시 출연금
- `출연금-아산시`: 아산시 출연금
- `보조금-국비`: 국비 보조금
- `보조금-도비`: 도비 보조금
- `보조금-천안시`: 천안시 보조금
- `자체재원`: 자체재원

**주의사항:**
- 시군명은 정확히 입력: `천안시`, `아산시`, `공주시`, `보령시`, `서산시`, `논산시`, `계룡시`, `당진시`, `금산군`, `부여군`, `서천군`, `청양군`, `홍성군`, `예산군`, `태안군`
- `천안`만 입력해도 인식되지만, `천안시`로 입력하는 것을 권장합니다.

#### 방법 2: 합계 컬럼만 사용

```
사업명 | 소관부서 | 합계 | 출연금 | 보조금 | 자체재원
```

이 경우:
- `출연금`은 모두 도비로 분류됩니다
- `보조금`은 모두 국비로 분류됩니다
- 시군별 세부 분류는 불가능합니다

### 현재 문제: "충남정보문화산업진흥원 운영" 사업

**현재 상황:**
- 출연금-도비: 2,020,000,000원 (전체가 들어감)
- 출연금-천안: 380,000,000원 (인식 안됨)
- 자체재원: 25,000,000원

**해결 방법:**

Excel 파일에서 다음과 같이 컬럼을 분리하세요:

| 사업명 | 소관부서 | 합계 | 출연금-도비 | 출연금-천안시 | 자체재원 |
|--------|----------|------|-------------|--------------|----------|
| 충남정보문화산업진흥원 운영 | 경영기획실 | 2,045,000,000 | 1,640,000,000 | 380,000,000 | 25,000,000 |

또는:

| 사업명 | 소관부서 | 합계 | 출연금-도비 | 출연금-천안 | 자체재원 |
|--------|----------|------|-------------|-------------|----------|
| 충남정보문화산업진흥원 운영 | 경영기획실 | 2,045,000,000 | 1,640,000,000 | 380,000,000 | 25,000,000 |

**중요:**
- `출연금-도비`와 `출연금-천안시` (또는 `출연금-천안`)를 **별도 컬럼**으로 만들어야 합니다
- 하나의 `출연금` 컬럼에 합계를 넣으면 모두 도비로 분류됩니다

## 🔍 컬럼명 인식 규칙

### 출연금 컬럼
- `출연금-도비`, `출연-도비`, `출연금-도` → 도비 출연금
- `출연금-천안시`, `출연금-천안`, `출연-천안시` → 천안시 출연금
- `출연금-아산시`, `출연금-아산`, `출연-아산시` → 아산시 출연금
- `출연금` (단독) → 도비 출연금으로 분류

### 보조금 컬럼
- `보조금-국비`, `보조-국비`, `보조금-국고` → 국비 보조금
- `보조금-도비`, `보조-도비`, `보조금-도` → 도비 보조금
- `보조금-천안시`, `보조금-천안`, `보조-천안시` → 천안시 보조금
- `보조금` (단독) → 국비 보조금으로 분류

### 자체재원 컬럼
- `자체재원`, `자체`, `자체예산`, `자체자금` → 자체재원

## 📝 예시 Excel 구조

### 권장 구조 (세부 분리)

```
| 구분 | 사업명 | 소관부서 | 합계 | 출연금-도비 | 출연금-천안시 | 출연금-아산시 | 보조금-국비 | 보조금-도비 | 보조금-천안시 | 자체재원 |
|------|--------|----------|------|-------------|--------------|--------------|-------------|-------------|--------------|----------|
| 기관운영 | 충남정보문화산업진흥원 운영 | 경영기획실 | 2,045,000,000 | 1,640,000,000 | 380,000,000 | 0 | 0 | 0 | 0 | 25,000,000 |
```

### 간단한 구조 (합계만)

```
| 사업명 | 소관부서 | 합계 | 출연금 | 보조금 | 자체재원 |
|--------|----------|------|--------|--------|----------|
| 충남정보문화산업진흥원 운영 | 경영기획실 | 2,045,000,000 | 2,020,000,000 | 0 | 25,000,000 |
```

## ⚠️ 주의사항

1. **시군별 세부 분류가 필요한 경우**: 반드시 각 시군을 별도 컬럼으로 만들어야 합니다
2. **컬럼명 일관성**: 같은 의미의 컬럼은 항상 같은 이름을 사용하세요
3. **시군명 정확성**: `천안시`, `아산시` 등 정확한 시군명을 사용하세요 (또는 `천안`, `아산`만 있어도 인식 가능)
4. **합계 컬럼**: `합계` 컬럼은 각 행의 모든 재원의 합계여야 합니다

## 🔧 파싱 로직 개선 사항

최신 파싱 로직은 다음과 같이 개선되었습니다:

1. **시군 컬럼 우선 인식**: 시군명이 포함된 컬럼을 먼저 찾아서 도비 컬럼과 구분
2. **다양한 형식 지원**: `출연금-천안시`, `출연금-천안`, `출연-천안시` 모두 인식
3. **디버깅 로그**: 처음 몇 개 행의 파싱 결과를 로그로 출력하여 확인 가능

## 💡 문제 해결 체크리스트

파싱이 제대로 안 될 때 확인할 사항:

- [ ] Excel 파일의 헤더 행이 올바른지 확인 (사업명, 부서, 합계 포함)
- [ ] 시군별 컬럼이 별도로 있는지 확인 (`출연금-천안시` 등)
- [ ] 컬럼명에 오타가 없는지 확인
- [ ] 숫자 형식이 올바른지 확인 (쉼표 포함 가능)
- [ ] 빈 행이나 소계 행이 데이터 행으로 인식되지 않는지 확인

