# 최종 해결 방법 - 단계별 가이드

## 🎯 목표
CORS 오류를 해결하고 Google Sheets 연동을 정상 작동시키기

## ✅ 가장 간단한 해결 방법 (5분 소요)

### 단계 1: Google Apps Script 배포 완전 재설정

**1-1. 기존 배포 삭제**
1. https://script.google.com 접속
2. 프로젝트 선택
3. `배포` → `배포 관리` 클릭
4. 기존 배포 옆의 **휴지통 아이콘** 클릭하여 삭제

**1-2. 코드 확인**
1. `GOOGLE_APPS_SCRIPT_FULL_CODE.js` 파일 열기
2. 전체 내용 복사 (Ctrl+A, Ctrl+C)
3. Google Apps Script 편집기에 붙여넣기
4. 저장 (Ctrl+S)

**1-3. 새로 배포**
1. `배포` → `새 배포` 클릭
2. `유형 선택` → `웹 앱` 선택
3. 설정:
   - 설명: `예산관리시스템`
   - 다음 사용자로 실행: `나`
   - **액세스 권한: `모든 사용자`** ⚠️ **가장 중요!**
4. `배포` 클릭
5. **Web App URL 복사** (예: `https://script.google.com/macros/s/.../exec`)

**1-4. 권한 승인**
1. 복사한 URL을 브라우저 새 탭에서 열기
2. 권한 승인 팝업이 나타나면 `허용` 클릭
3. JSON 응답이 보이면 성공: `{"success":true,...}`

**1-5. 프론트엔드 설정**
1. 예산 관리 시스템 설정 페이지로 이동
2. "Google Apps Script Web App URL" 필드에 복사한 URL 입력
3. 저장

**1-6. 테스트**
1. 파일 업로드 페이지로 이동
2. "표준 형식으로 Google Sheets 생성" 버튼 클릭
3. 새 탭에서 Google Sheets가 열리면 성공! ✅

---

## 🔄 문제가 계속되면

### 확인 사항 체크리스트

- [ ] URL이 `/exec`로 끝나는가? (❌ `/dev` 아님)
- [ ] "액세스 권한: 모든 사용자"로 설정했는가?
- [ ] 권한을 승인했는가?
- [ ] 브라우저 캐시를 클리어했는가? (Ctrl+Shift+Delete)
- [ ] 시크릿 모드에서 테스트했는가?

---

## 💡 대안: Google Apps Script 없이 사용하기

만약 위 방법이 작동하지 않거나, 더 간단한 방법을 원하시면:

### 옵션 A: Google Sheets 수동 생성
1. Google Sheets에서 직접 파일 생성
2. 수동으로 데이터 입력
3. 앱에서 "Google Sheets에서 가져오기" 기능 사용

### 옵션 B: Excel 파일 직접 다운로드
1. 앱에서 Excel 형식으로 내보내기 기능 추가
2. 다운로드한 Excel 파일을 Google Sheets에 업로드

---

## 📝 다음 단계

**어떤 방법으로 진행하시겠습니까?**

1. **단계 1부터 다시 시도** (가장 추천)
2. **대안 방법 사용** (Google Apps Script 없이)
3. **다른 문제 해결** (다른 기능 작업)

선택해주시면 해당 방법의 상세 가이드를 제공하겠습니다.

